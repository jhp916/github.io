
<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>foton VR ì¤‘í•™êµ 1í•™ë…„ â€“ ì£¼ì œ/ì±•í„° íƒìƒ‰</title>
<style>
  /* ===== fotonvr.com ëŠë‚Œì„ ì‚´ë¦° ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ ===== */
  :root{
    --brand:#f06a21;
    --brand-2:#02d1c6; /* ê·¸ë¼ë°ì´ì…˜ í¬ì¸íŠ¸ */
    --ink:#0b1533;
    --muted:#b6c0d3;
    --bg-deep:#0a0b2e;
    --bg-mid:#251b57;
    --bg-top:#512b79;
    --line:rgba(255,255,255,.14);
    --card:#10163a;
    --radius:18px;
    --pill:9999px;
    --shadow:0 14px 30px rgba(0,0,0,.28);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    color:#eef3ff;
    font-family: Inter, Pretendard, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', Arial, sans-serif;
    background:
      radial-gradient(1200px 600px at 80% 10%, rgba(2,209,198,.18), transparent 60%),
      radial-gradient(900px 500px at 10% 20%, rgba(240,106,33,.22), transparent 60%),
      linear-gradient(140deg, var(--bg-top), var(--bg-mid) 40%, var(--bg-deep) 80%);
  }
  /* í—¤ë” (ì—‘ì…€ ë²„íŠ¼ ì œê±°) */
  header{position:sticky;top:0;z-index:40;background:rgba(10,11,46,.5);backdrop-filter: blur(10px);border-bottom:1px solid var(--line)}
  .h-wrap{max-width:1200px;margin:0 auto;padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .logo{display:flex;align-items:center;gap:10px}
  .logo-mark{background:#fff;color:var(--brand);font-weight:900;border-radius:var(--pill);padding:6px 12px}
  .logo-title{font-weight:900;letter-spacing:.2px}
  /* íˆì–´ë¡œ ì„¹ì…˜: ì „ì²´ ë°°ê²½í˜• ì´ë¯¸ì§€ + ê³¼í•™ ì•„ì´ì½˜ */
  .hero{position:relative;overflow:hidden;border-bottom:1px solid var(--line)}
  .hero-wrap{max-width:1200px;margin:0 auto;padding:46px 16px;display:grid;grid-template-columns:1.1fr 1fr;gap:24px;align-items:center}
  @media (max-width:980px){.hero-wrap{grid-template-columns:1fr;padding:28px 16px}}
  .hero h1{margin:0;font-size:38px;line-height:1.2}
  .accent{background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent}
  .hero-visual{position:relative;border-radius:28px;overflow:hidden;box-shadow:var(--shadow);border:1px solid var(--line)}
  .hero-visual::after{content:'';position:absolute;inset:0;background:radial-gradient(800px 400px at 20% 10%, rgba(255,255,255,.08), transparent 60%)}
  .hero-img{display:block;width:100%;height:auto}
  /* ì•± ë ˆì´ì•„ì›ƒ */
  .app{max-width:1200px;margin:0 auto;padding:18px 16px}
  .app-grid{display:grid;grid-template-columns:320px 1fr;gap:16px}
  @media (max-width:980px){.app-grid{grid-template-columns:1fr}}
  /* ì¢Œì¸¡ íŒ¨ë„ */
  .panel{background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow)}
  .panel-title{display:flex;align-items:center;gap:8px;padding:14px 16px;border-bottom:1px solid var(--line);font-weight:900}
  .panel-body{padding:14px 16px}
  .search{display:flex;gap:10px;align-items:center;border:1px solid var(--line);border-radius:var(--pill);padding:10px 12px;background:rgba(255,255,255,.04)}
  .search input{flex:1;border:0;outline:none;background:transparent;color:#fff}
  .subject-list{display:flex;flex-direction:column;gap:10px;max-height:60vh;overflow:auto;padding-right:6px}
  .pill-item{text-align:left;padding:12px 14px;border:1px solid var(--line);border-radius:var(--pill);background:rgba(255,255,255,.05);cursor:pointer;transition:.2s;font-weight:800}
  .pill-item:hover{transform:translateY(-1px)}
  .pill-item.active{background:#fff;color:#0b1533}
  .pill-sub{display:block;margin-top:4px;color:#c2cbe0;font-weight:600;font-size:12px}
  /* ìš°ì¸¡: ì±•í„° ë¦¬ìŠ¤íŠ¸ */
  .section{background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
  .section-bar{display:flex;align-items:end;justify-content:space-between;gap:10px;padding:14px 16px;border-bottom:1px solid var(--line)}
  .section-title{font-weight:900;font-size:18px}
  .section-meta{color:#d0d7ea;font-size:13px}
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;padding:12px}
  @media (max-width:720px){.grid{grid-template-columns:1fr}}
  .card{border:1px solid var(--line);border-radius:20px;background:rgba(255,255,255,.04);overflow:hidden}
  .row{display:flex;gap:12px;padding:12px}
  .thumb{width:64px;height:64px;background:rgba(255,255,255,.06);border:1px solid var(--line);border-radius:14px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .meta{color:#cfd6ea;font-size:13px;margin-top:3px}
  .nums{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .nums .tag{background:rgba(255,255,255,.08);border:1px solid var(--line);padding:6px 10px;border-radius:12px;font-weight:900;font-size:14px}
  .actions{display:flex;gap:8px;padding:0 12px 14px 12px}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 16px;border-radius:var(--pill);background:linear-gradient(90deg,var(--brand),var(--brand-2));border:0;color:#0b1533;font-weight:900;cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid var(--line);color:#eef3ff}
  /* í¼ì¹¨ íŒ¨ë„(ì• ë‹ˆë©”ì´ì…˜) */
  .expand{max-height:0;overflow:hidden;transition:max-height .35s ease, opacity .3s ease;opacity:0;border-top:1px solid var(--line)}
  .expand.open{opacity:1}
  .expand-inner{padding:14px}
  .preview{width:100%;max-height:60vh;display:flex;align-items:center;justify-content:center;background:#0e1333;border:1px solid var(--line);border-radius:14px;overflow:hidden}
  
.preview img {
    max-width: 100%;
    max-height: 80vh !important; /* í¬ê²Œ í™•ëŒ€ */
    object-fit: contain;
    background: #000;
}

  .expand-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .close-btn{border:1px solid var(--line);background:transparent;color:#fff;border-radius:var(--pill);padding:8px 12px;cursor:pointer}
  /* ë¹ˆ ìƒíƒœ */
  .empty{margin:12px;padding:16px;text-align:center;color:#cfd6ea;border:1px dashed var(--line);border-radius:14px}

.subject-list button, 
.subject-list .pill {
    color: white !important;
}


.subject-list button.active, 
.subject-list .pill.active {
    color: black !important;
}


/* === ë¼ì´íŠ¸ë°•ìŠ¤ === */
.lightbox{position:fixed; inset:0; background:rgba(0,0,0,.88); display:none; align-items:center; justify-content:center; z-index:9999; padding:24px;}
.lightbox.show{display:flex;}
.lightbox img{max-width:95vw; max-height:95vh; object-fit:contain; display:block; background:#000; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,.6);}
.lightbox .close{position:absolute; top:16px; right:16px; background:#ffffff; color:#111827; border:1px solid #e5e7eb; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:700;}
.lightbox .msg{color:#e5e7eb; font-size:14px;}


/* ì €ì¥ í† ìŠ¤íŠ¸ */
.toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%); background:#111827; color:#fff; border:1px solid #374151; border-radius:12px; padding:10px 14px; box-shadow:0 10px 24px rgba(0,0,0,.3); opacity:0; pointer-events:none; transition:opacity .25s ease, transform .25s ease; z-index:10000;}
.toast.show{opacity:1; transform:translateX(-50%) translateY(-6px);}

</style>
</head>
<body>
<header>
<div class="h-wrap">
<div class="logo">
<span class="logo-mark">foton VR</span>
<div class="logo-title">ì¤‘í•™êµ 1í•™ë…„ ì½˜í…ì¸  íƒìƒ‰</div>
</div>
<!-- ìƒë‹¨ ì˜¤ë¥¸ìª½ ì—‘ì…€ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ ì œê±°ë¨ -->
</div>
</header>
<section class="hero">
<div class="hero-wrap">
<div>
<h1>ê°€ìƒí˜„ì‹¤ë¡œ í˜ì‹ í•˜ëŠ” ê³¼í•™ êµìœ¡</h1>
<p style="margin-top:10px;color:#e0e6ff">3D VR ê³¼í•™êµìœ¡ìë£Œ</p>
</div>
<div class="hero-visual">
<img alt="foton style visual" class="hero-img" src="sandbox:/mnt/data/7eed1d74-b8b3-48df-9c38-aae3b93f96a6.png"/>
</div>
</div>
</section>
<div class="app">
<div class="app-grid">
<!-- Left: subject -->
<aside class="panel">
<div class="panel-title">ğŸ“‚ ì£¼ì œ ì„ íƒ</div>
<div class="panel-body">
<div class="search">
<span>ğŸ”</span>
<input id="searchInput" placeholder="ì£¼ì œì´ë¦„/ì±•í„°ì´ë¦„ ê²€ìƒ‰"/>
</div>
<div class="subject-list" id="subjectList"></div>
</div>
</aside>
<!-- Right: content -->
<section class="section">
<div class="section-bar">
<div>
<div class="section-title">ì±•í„° ëª©ë¡</div>
<div class="section-meta" id="resultCount">ê²€ìƒ‰ ê²°ê³¼ 0ê±´</div>
</div>
<div class="section-meta">fotonvr.com inspired UI</div>
</div>
<div class="grid" id="chapterGrid"></div>
<div class="empty" id="emptyState" style="display:none;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ì¢Œì¸¡ì—ì„œ ì£¼ì œë¥¼ ì„ íƒí•˜ê±°ë‚˜ ê²€ìƒ‰í•´ë³´ì„¸ìš”.</div>
</section>
</div>
</div>
<script>
const EMBEDDED_ROWS = [{"STD": "5", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ì‹í’ˆì˜ ë¶€íŒ¨"}, {"STD": "5", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ìš°ìœ ì˜ ë¶€íŒ¨"}, {"STD": "5", "ì£¼ì œë²ˆí˜¸": "7", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ìˆ˜ìš©ì„± ë¬¼ì§ˆê³¼ ë¶ˆìš©ì„± ë¬¼ì§ˆ"}, {"STD": "5", "ì£¼ì œë²ˆí˜¸": "11", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë”ìš´ ê³µê¸°ì™€ ì°¬ ê³µê¸°"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë¬¼ì§ˆ ë¶„ë¦¬í•˜ê¸°"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì²´ë¥¼ ì´ìš©í•œ ë¶„ë¦¬ë²•"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ì—¬ëŸ¬ê°€ì§€ ë¶„ë¦¬ë²•:ì¹¨ì „, ê¸°ìœ¨ì—¬ ë”°ë¥´ê¸°, ì—¬ê³¼ë²•"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "í¬í™”, ì¦ë°œ, ê·¸ë¦¬ê³  ì‘ì¶•"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ê°€ì—­ ë³€í™”ì™€ ë¹„ê°€ì—­ ë³€í™”-1"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ê°€ì—­ ë³€í™”ì™€ ë¹„ê°€ì—­ ë³€í™”-2"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ê°€ì—­ ë³€í™”ì™€ ë¹„ê°€ì—­ ë³€í™”-3"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "13", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì –ì€ ì˜·ì—ì„œ ë¬¼ì´ ì¦ë°œí•˜ëŠ” ê³¼ì •"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ê³µê¸° ì†ì— ìˆëŠ” ë¨¼ì§€ì™€ ì—°ê¸°"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "5", "ì±•í„°ì´ë¦„": "ê³µê¸°ì˜ êµ¬ì„± ìš”ì†Œ"}, {"STD": "6", "ì£¼ì œë²ˆí˜¸": "15", "ì£¼ì œì´ë¦„": "ê³¼í•™ê³¼ ì¸ë¥˜ì˜ ì§€ì†ê°€ëŠ¥í•œ ì‚¶", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì§‘ì—ì„œ ì¬í™œìš© ì¢…ì´ ë§Œë“¤ê¸°"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "2", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì•„ë©”ë°”ì˜ ì˜ì–‘"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "3", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ì˜¨ë„ê³„ì˜ ì¢…ë¥˜"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "3", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ê³µê¸°ì˜ ëŒ€ë¥˜"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "3", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì—´ì˜ í¡ìˆ˜-í°ìƒ‰ê³¼ ê²€ì€ìƒ‰"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë¬¼ë¦¬ì  ë³€í™”ì˜ ì¢…ë¥˜-1"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë¬¼ë¦¬ì  ë³€í™”ì˜ ì¢…ë¥˜-2"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "7", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ê³µê¸°ê°€ íë¥´ëŠ” ë°©í–¥"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "7", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì—´ì„ ê°€í•˜ë©´ íŒ½ì°½í•˜ëŠ” ê³µê¸°"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "12", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ì¤„ê¸°ì ˆë‹¨ì— ì˜í•œ ì˜ì–‘ë²ˆì‹"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "12", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ìì— ì˜í•œ ì˜ì–‘ë²ˆì‹"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "12", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì„ ì¸ì¥ì˜ ì˜ì–‘ë²ˆì‹"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "13", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "í•´ìº„ì˜ ë¶„ì—´ë²•ì— ì˜í•œ ë²ˆì‹"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "13", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "í¬ìë¡œ ë²ˆì‹í•˜ëŠ” ì–‘ì¹˜ ì‹ë¬¼"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "15", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì‹œê°„ ì¸¡ì •í•˜ê¸°"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "19", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ìˆ²ì—ëŠ” ëˆ„ê°€ ì‚´ê¹Œìš”?"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "19", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë¨¹ì´ì‚¬ìŠ¬-1"}, {"STD": "7", "ì£¼ì œë²ˆí˜¸": "19", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ë¨¹ì´ì‚¬ìŠ¬-2"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "1", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë¯¸ìƒë¬¼:ìœ ìµí• ê¹Œìš”, ìœ í•´í• ê¹Œìš”?"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "1", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë°”ì´ëŸ¬ìŠ¤:í™•ì‚°ê³¼ ì˜í–¥"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "1", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ê³°íŒ¡ì´ì™€ ë²ˆì‹"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ì—°ì†Œì˜¨ë„ì™€ ë°œí™”ì˜¨ë„"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ì¢…ì´ì»µì— ë¬¼ ë°ìš°ê¸°"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "5", "ì£¼ì œì´ë¦„": "ì—´ê³¼ ìš°ë¦¬ ìƒí™œ", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì—°ì†Œì˜ ì¢…ë¥˜"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "6", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "5", "ì±•í„°ì´ë¦„": "ë¬´ì„±ìƒì‹:ì¶œì•„ë²•"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "6", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "6", "ì±•í„°ì´ë¦„": "ì•„ë©”ë°”ì˜ ì´ë¶„ë²•"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "í˜"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë¬¼ì²´ì˜ ìš´ë™ê³¼ ëª¨ì–‘ì— ë¯¸ì¹˜ëŠ” í˜ì˜ ì˜í–¥"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "í˜ì˜ ì¢…ë¥˜"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì••ë ¥ì€ ë¬´ì—‡ì¼ê¹Œìš”?"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë§ˆì°°ì€ ë¬´ì—‡ì¼ê¹Œìš”?"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë§ˆì°°ë ¥"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ë§ˆì°°ì„ ì¼ìœ¼í‚¤ëŠ” ìš”ì¸ë“¤"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ë§ˆì°°ì˜ ì¥ì ê³¼ ë‹¨ì "}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "5", "ì±•í„°ì´ë¦„": "ë§ˆì°°ì˜ ì¦ê°€ì™€ ê°ì†Œ"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "6", "ì±•í„°ì´ë¦„": "êµ¬ë¦„ ë§ˆì°°"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "9", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "7", "ì±•í„°ì´ë¦„": "ìœ ì²´ ë§ˆì°°"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "íƒœì–‘ê³„", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ì§€êµ¬ì˜ ë‚®ê³¼ ë°¤ì˜ ì£¼ê¸°"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "íƒœì–‘ê³„", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë‹¬ì˜ ìœ„ìƒ"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "íƒœì–‘ê³„", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "íƒœì–‘ê³„"}, {"STD": "8", "ì£¼ì œë²ˆí˜¸": "14", "ì£¼ì œì´ë¦„": "íƒœì–‘ê³„", "ì±•í„°ë²ˆí˜¸": "7", "ì±•í„°ì´ë¦„": "ì§€êµ¬ì˜ ê³„ì ˆë³€í™”"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "1", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "1", "ì£¼ì œì´ë¦„": "ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ë¬¼ì§ˆ ìƒíƒœì˜ ë³€í™”"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "4", "ì£¼ì œì´ë¦„": "ê¸°ì²´ì˜ ì„±ì§ˆ", "ì±•í„°ë²ˆí˜¸": "6", "ì±•í„°ì´ë¦„": "í¬ê°€ìŠ¤(ë¹„í™œì„± ê¸°ì²´)"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ìƒë¬¼í•™ì  ë¶„ë¥˜"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "5ê³„ ë¶„ë¥˜ì²´ê³„"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "8", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "6", "ì±•í„°ì´ë¦„": "ì´í•­ ëª…ëª…ë²•"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "10", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "í˜ì˜ í‰í˜•ê³¼ ë¶ˆê· í˜•ë ¥"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "11", "ì£¼ì œì´ë¦„": "íƒœì–‘ê³„", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ì§€êµ¬ì™€ ë‹¬ì— ìˆëŠ” ë¬¼ì²´ì˜ ì§ˆëŸ‰ê³¼ ë¬´ê²Œ"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "11", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ì¶”ë ¥ê³¼ ì••ë ¥"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "11", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "5", "ì±•í„°ì´ë¦„": "ì•„ë¥´í‚¤ë©”ë°ìŠ¤ ì›ë¦¬"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "12", "ì£¼ì œì´ë¦„": "í˜ì˜ ì‘ìš©", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë™ë ¥"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "17", "ì£¼ì œì´ë¦„": "ê³¼í•™ê³¼ ì¸ë¥˜ì˜ ì§€ì†ê°€ëŠ¥í•œ ì‚¶", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ëŒ€ê¸°ì˜¤ì—¼:ì›ì¸ê³¼ ê²°ê³¼"}, {"STD": "9", "ì£¼ì œë²ˆí˜¸": "17", "ì£¼ì œì´ë¦„": "ê³¼í•™ê³¼ ì¸ë¥˜ì˜ ì§€ì†ê°€ëŠ¥í•œ ì‚¶", "ì±•í„°ë²ˆí˜¸": "4", "ì±•í„°ì´ë¦„": "ìˆ˜ì§ˆì˜¤ì—¼:ì›ì¸ê³¼ ê²°ê³¼"}, {"STD": "10", "ì£¼ì œë²ˆí˜¸": "12", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "íˆë“œë¼ì˜ ì¬ìƒ"}, {"STD": "10", "ì£¼ì œë²ˆí˜¸": "23", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "1", "ì±•í„°ì´ë¦„": "ë¨¹ì´ì‚¬ìŠ¬"}, {"STD": "10", "ì£¼ì œë²ˆí˜¸": "23", "ì£¼ì œì´ë¦„": "ìƒë¬¼ì˜ êµ¬ì„±ê³¼ ë‹¤ì–‘ì„±", "ì±•í„°ë²ˆí˜¸": "2", "ì±•í„°ì´ë¦„": "ë¨¹ì´ê·¸ë¬¼"}, {"STD": "10", "ì£¼ì œë²ˆí˜¸": "23", "ì£¼ì œì´ë¦„": "ê³¼í•™ê³¼ ì¸ë¥˜ì˜ ì§€ì†ê°€ëŠ¥í•œ ì‚¶", "ì±•í„°ë²ˆí˜¸": "3", "ì±•í„°ì´ë¦„": "ì˜¤ì¡´ì¸µê³¼ ì˜¤ì¡´ì¸µ íŒŒê´´"}];

// State
let rows = EMBEDDED_ROWS.slice();
let imagesMap = loadImages();
let selectedSubject = "";
let query = "";

// Utils
function keyOf(r){ return [r['STD'], r['ì£¼ì œë²ˆí˜¸'], r['ì±•í„°ë²ˆí˜¸'], r['ì£¼ì œì´ë¦„'], r['ì±•í„°ì´ë¦„']].join('::'); }
function loadImages(){ try{ return JSON.parse(localStorage.getItem('foton_m1_images_v1')) || {}; } catch(e){ return {}; } }
function saveImages(){ localStorage.setItem('foton_m1_images_v1', JSON.stringify(imagesMap)); }

// Grouped subjects by name
function subjects(){
  const map = new Map();
  rows.forEach(r=>{
    const name = String(r['ì£¼ì œì´ë¦„']||'').trim();
    const no = String(r['ì£¼ì œë²ˆí˜¸']||'').trim();
    if(!name) return;
    if(!map.has(name)) map.set(name,{name, nos:new Set()});
    if(no) map.get(name).nos.add(no);
  });
  return Array.from(map.values()).map(s=>({name:s.name, nos:Array.from(s.nos).sort((a,b)=>parseFloat(a)-parseFloat(b))}))
             .sort((a,b)=> a.name.localeCompare(b.name,'ko'));
}

// Filtered chapters
function filteredChapters(){
  const q = query.trim().toLowerCase();
  return rows.filter(r=>{
    const subjMatch = selectedSubject ? (r['ì£¼ì œì´ë¦„']===selectedSubject) : true;
    if(!q) return subjMatch;
    const hay = (r['ì£¼ì œì´ë¦„']+' '+r['ì±•í„°ì´ë¦„']).toLowerCase();
    return subjMatch && hay.includes(q);
  }).map(r=>({
    key: keyOf(r),
    std: String(r['STD']||''),
    subjNo: String(r['ì£¼ì œë²ˆí˜¸']||''),
    subjName: String(r['ì£¼ì œì´ë¦„']||''),
    chapNo: String(r['ì±•í„°ë²ˆí˜¸']||''),
    chapName: String(r['ì±•í„°ì´ë¦„']||'')
  })).sort((a,b)=>{
    const s = a.subjName.localeCompare(b.subjName,'ko'); if(s!==0) return s;
    const an = parseFloat(a.chapNo), bn = parseFloat(b.chapNo);
    if(!isNaN(an) && !isNaN(bn)) return an-bn;
    return a.chapNo.localeCompare(b.chapNo,'ko');
  });
}

// DOM
const subjectList = document.getElementById('subjectList');
const chapterGrid = document.getElementById('chapterGrid');
const resultCount = document.getElementById('resultCount');

function renderSubjects(){
  subjectList.innerHTML='';
  const all = document.createElement('button');
  all.className = 'pill-item' + (selectedSubject===''?' active':'');
  all.textContent = 'ì „ì²´ ë³´ê¸°';
  all.onclick = ()=>{ selectedSubject=''; renderAll(); };
  subjectList.appendChild(all);

  subjects().forEach(s=>{
    const btn = document.createElement('button');
    btn.className = 'pill-item' + (selectedSubject===s.name?' active':'');
    const nos = '';
    btn.innerHTML = '<div>'+s.name+'</div>' + (nos?'<span class="pill-sub">'+nos+'</span>':'');
    btn.onclick = ()=>{ selectedSubject=s.name; renderAll(); };
    subjectList.appendChild(btn);
  });
}

function renderChapters(){
  const list = filteredChapters();
  chapterGrid.innerHTML='';
  document.getElementById('emptyState').style.display = list.length? 'none':'block';
  resultCount.textContent = 'ê²€ìƒ‰ ê²°ê³¼ ' + list.length.toLocaleString() + 'ê±´';

  list.forEach(ch=>{
    const card = document.createElement('div');
    card.className='card';

    // Card body
    const body = document.createElement('div');
    body.className='row';
    body.innerHTML = ''
      + '<div class="thumb">'+ (imagesMap[ch.key] ? '<img src="'+imagesMap[ch.key]+'"/>' : 'ğŸ–¼ï¸') + '</div>'
      + '<div style="flex:1;min-width:0;">'
      +   '<div style="font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis" title="'+ch.chapName+'">'+ch.chapName+'</div>'
      +   '<div class="meta" title="'+ch.subjName+'">'+ch.subjName+'</div>'
      +   '<div class="nums">'
      +     '<span class="tag">STD '+(ch.std||'-')+'</span>'
      +     '<span class="tag">ì£¼ì œë²ˆí˜¸ '+(ch.subjNo||'-')+'</span>'
      +     '<span class="tag">ì±•í„°ë²ˆí˜¸ '+(ch.chapNo||'-')+'</span>'
      +   '</div>'
      + '</div>';
    card.appendChild(body);

    // Actions
    const actions = document.createElement('div');
    actions.className='actions';
    const openBtn = document.createElement('button');
    openBtn.className='btn'; openBtn.textContent='ìƒì„¸ ë³´ê¸°';
    const uploadLabel = document.createElement('label');
    uploadLabel.className='btn ghost'; uploadLabel.innerHTML = '<input type="file" accept="image/*" style="display:none"/>ì´ë¯¸ì§€ ì¶”ê°€';
    actions.appendChild(openBtn);
    actions.appendChild(uploadLabel);
    card.appendChild(actions);

    // ìƒˆì°½ìœ¼ë¡œ í° ì´ë¯¸ì§€ ì—´ê¸°
    openBtn.onclick = () => { const src = imagesMap[ch.key] || ''; openLightbox(src, ch.chapName); };
    // Upload (per-card, not inside expand)
    const input = uploadLabel.querySelector('input');
    input.onchange = (e)=>{
      const f = e.target.files && e.target.files[0]; if(!f) return;
      const fr = new FileReader();
      fr.onload = ()=>{ imagesMap[ch.key]=fr.result; saveImages(); renderAll(); showToast('ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ');};
      fr.readAsDataURL(f);
    };

    chapterGrid.appendChild(card);
  });
}

function renderAll(){ renderSubjects(); renderChapters(); }
document.getElementById('searchInput').addEventListener('input', (e)=>{ query = e.target.value; renderChapters(); });
renderAll();

// === ìƒˆì°½ ì´ë¯¸ì§€ ë·°ì–´ ===
function openImageWin(src, title){
  const w = window.open('', '_blank');
  if (!w) { alert('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.'); return; }
  const safeTitle = (title || 'ì´ë¯¸ì§€').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  const body = src 
    ? '<img src="'+src+'" alt="'+safeTitle+'" />'
    : '<div style="color:#fff;font:14px/1.6 system-ui, -apple-system, Segoe UI, Roboto, \'Noto Sans KR\', Arial, sans-serif;">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
  const doc = `<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>${safeTitle}</title>
<style>
  html, body { height:100%; margin:0; background:#000; display:flex; align-items:center; justify-content:center; }
  img { max-width:95vw; max-height:95vh; object-fit:contain; display:block; }

/* === ë¼ì´íŠ¸ë°•ìŠ¤ === */
.lightbox{position:fixed; inset:0; background:rgba(0,0,0,.88); display:none; align-items:center; justify-content:center; z-index:9999; padding:24px;}
.lightbox.show{display:flex;}
.lightbox img{max-width:95vw; max-height:95vh; object-fit:contain; display:block; background:#000; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,.6);}
.lightbox .close{position:absolute; top:16px; right:16px; background:#ffffff; color:#111827; border:1px solid #e5e7eb; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:700;}
.lightbox .msg{color:#e5e7eb; font-size:14px;}


/* ì €ì¥ í† ìŠ¤íŠ¸ */
.toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%); background:#111827; color:#fff; border:1px solid #374151; border-radius:12px; padding:10px 14px; box-shadow:0 10px 24px rgba(0,0,0,.3); opacity:0; pointer-events:none; transition:opacity .25s ease, transform .25s ease; z-index:10000;}
.toast.show{opacity:1; transform:translateX(-50%) translateY(-6px);}

</style>
</head><body>${body}
<div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-label="ì´ë¯¸ì§€ ë¼ì´íŠ¸ë°•ìŠ¤">
  <button class="close" id="lightboxClose">ë‹«ê¸°</button>
  <img id="lightboxImg" alt="chapter full"/>
  <div id="lightboxMsg" class="msg" style="display:none;">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
</div>

<div id="toast" class="toast">ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ</div>
</body></html>`;
  w.document.open();
  w.document.write(doc);
  w.document.close();
}



// === Lightbox Logic (dynamic wiring) ===
let __lb_last_focus = null;
function openLightbox(src, title){
  const lb = document.getElementById('lightbox');
  const img = document.getElementById('lightboxImg');
  const msg = document.getElementById('lightboxMsg');
  const btn = document.getElementById('lightboxClose');
  __lb_last_focus = document.activeElement;

  if (src){
    img.src = src;
    img.style.display = 'block';
    msg.style.display = 'none';
  } else {
    img.removeAttribute('src');
    img.style.display = 'none';
    msg.style.display = 'block';
  }

  // Wire events only once, at first open (elements now definitely exist)
  if (!lb.dataset.bound){
    btn.addEventListener('click', closeLightbox);
    lb.addEventListener('click', (e)=>{ if (e.target === e.currentTarget) closeLightbox(); });
    document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') closeLightbox(); });
    lb.dataset.bound = '1';
  }

  lb.classList.add('show');
  document.body.style.overflow = 'hidden';
}

function closeLightbox(){
  const lb = document.getElementById('lightbox');
  lb.classList.remove('show');
  document.body.style.overflow = '';
  if (__lb_last_focus && typeof __lb_last_focus.focus === 'function'){
    setTimeout(()=>{ try { __lb_last_focus.focus(); } catch(e){} }, 0);
  }
}


function showToast(msg){
  const t = document.getElementById('toast');
  if (!t) return;
  t.textContent = msg || 'ì €ì¥ ì™„ë£Œ';
  t.classList.add('show');
  setTimeout(()=> t.classList.remove('show'), 1800);
}

</script>

<div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-label="ì´ë¯¸ì§€ ë¼ì´íŠ¸ë°•ìŠ¤">
  <button class="close" id="lightboxClose">ë‹«ê¸°</button>
  <img id="lightboxImg" alt="chapter full"/>
  <div id="lightboxMsg" class="msg" style="display:none;">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
</div>

<div id="toast" class="toast">ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ</div>
</body>
</html>
